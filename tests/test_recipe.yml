_include:
  - (pfb)stimela_cabs.yaml

opts:
  log:
    dir: logs
    nest: 2

test_recipe:
  name: "PFB sample recipe"
  info: "just a demo recipe"

  inputs:
    ms:
      dtype: MS
      required: true
      abbreviation: ms
    data_column:
      dtype: str
      default: DATA
      abbreviation: dc
    weight_column:
      dtype: str
      default: WEIGHT_SPECTRUM
      abbreviation: wc
    flag_column:
      dtype: str
      default: FLAG
      abbreviation: fc
    field_of_view:
      dtype: float
      abbreviation: fov
      required: true
      info: 'Field of view in degrees'
      metavar: DEG
    super_resolution_factor:
      dtype: float
      abbreviation: srf
      default: 2.0
      info: 'Will over-sample Nyquist by this factor at max frequency'

  # an alias is a recipe parameter that maps to parameters of step(s)
  aliases:
    output_filename: [grid.output_filename, init.output_filename]
    nband: [grid.nband, init.nband]
    nthreads: [grid.nthreads, init.nthreads]

  steps:
    init:
      cab: pfb.init
      params:
        # an alternate way to achieve aliasing is via {}-substitutions
        # this is more flexible, but doesn't do proper type checking up front
        data_column: '{recipe.data_column}'
        weight_column: '{recipe.weight_column}'
        flag_column: '{recipe.flag_column}'
        ms: '{recipe.ms}'
        max_field_of_view: '{recipe.field_of_view}'

    grid:
      cab: pfb.grid
      params:
        field_of_view: '{recipe.field_of_view}'
        super_resolution_factor: '{recipe.super_resolution_factor}'
        robustness: -1

